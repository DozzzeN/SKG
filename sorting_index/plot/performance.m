clear; close all; clc
textSize = 16;
linewid = 1;

ep = [1 2 3 4];
% MI DCT DP ISa ISm
% SI DCT DP ISa ISm
% MO DCT DP ISa ISm
% SO DCT DP ISa ISm
% compBMR = [1-0.9846540178571429 1-0.9908854166666666 1-0.9997558594 1-0.9995605469;
%     1-0.9935825892857143 1-0.935546875 1-0.9998604911 1-0.9979870855;
%     1-0.9239211309523809 1-0.9981971153846154 1-0.9994303385 0;
%     1-0.9725632440476191 1-0.9876302083333334 1-0.9996744792 0];
compBMR = [1-0.9846540178571429 1-0.9908854166666666 0 0;
    1-0.9935825892857143 1-0.935546875 0 0;
    1-0.9239211309523809 1-0.9981971153846154 0 0;
    1-0.9725632440476191 1-0.9876302083333334 0 0];

figure(11)
bar(ep, compBMR, 'grouped')
hold on
ax = gca;
ax.YAxis.FontSize = 13;
ax.XAxis.FontSize = 13;
ax.YAxis.FontWeight = 'bold';
ax.XAxis.FontWeight = 'bold';

row1 = {'Mobile' 'Stationary' 'Mobile' 'Stationary'};
row2 = {'Indoor' 'Indoor' 'Outdoor' 'Outdoor'};
labelArray = [row1; row2]; 
tickLabels = strtrim(sprintf('%s\\newline%s \n', labelArray{:}));
ax.XTickLabel = tickLabels; 

ylim([0 0.15])
legend('DCT-Quantization', 'DP-SKG', 'SIC-SKGa', 'SIC-SKGm', 'FontSize', textSize, 'FontWeight','bold', 'Location','northeast')
ylabel('BMR (%)', 'FontSize',15, 'FontWeight','bold')

% for i=1:length(compBMR)
%     text(ep(i)-0.3,compBMR(i,1),num2str(compBMR(i,1), '%.2g'), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(ep(i)-0.1,compBMR(i,2),num2str(compBMR(i,2), '%.2g'), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(ep(i)+0.1,compBMR(i,3),strcat(num2str(compBMR(i,3), '%.3g')," /"), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(ep(i)+0.3,compBMR(i,4),num2str(compBMR(i,4), '%.2g'), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
% end

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.015',...
    'Position',[0.7 0.0153459821428571 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.0091',...
    'Position',[1.00092165898618 0.00911458333333337 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0 /',...
    'Position',[1.1 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0',...
    'Position',[1.26330121491412 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.0064',...
    'Position',[1.64495182237118 0.0064174107142857 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.064',...
    'Position',[1.9 0.064453125 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0 /',...
    'Position',[2.1 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0',...
    'Position',[2.26330121491412 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.076',...
    'Position',[2.7 0.0760788690476191 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.0018 /',...
    'Position',[3.03762044407206 0.00536724105102815 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0 /',...
    'Position',[3.1 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0',...
    'Position',[3.26330121491412 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.027',...
    'Position',[3.7 0.0274367559523809 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.012',...
    'Position',[3.97339757017176 0.0123697916666666 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0 /',...
    'Position',[4.1 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0',...
    'Position',[4.26330121491412 0 0]);

print('compvsquantBMR','-depsc')

% compBGR = [0.9 0.93 0.88 0.89; 
%     0.857 0.857 0.857 0.857; 
%     1.4 1.4 1.4 1.4; 
%     4.2 4.2 4.2 4.2];
compBGR = [0.90 1.0455 1.143 1.143;
    0.94 1.0676 1.143 1.143;
    0.87 0.9093 1.143 1.143;
    0.91 1.0822 1.143 1.143
    ];
figure(1111)
bar(ep, compBGR, 'grouped')
hold on
ax = gca;
ax.YAxis.FontSize = 13;
ax.XAxis.FontSize = 13;
ax.YAxis.FontWeight = 'bold';
ax.XAxis.FontWeight = 'bold';

row1 = {'Mobile' 'Stationary' 'Mobile' 'Stationary'};
row2 = {'Indoor' 'Indoor' 'Outdoor' 'Outdoor'};
labelArray = [row1; row2]; 
tickLabels = strtrim(sprintf('%s\\newline%s \n', labelArray{:}));
ax.XTickLabel = tickLabels; 

ylim([0 2.5])
legend('DCT-Quantization', 'DP-SKG', 'SIC-SKGa', 'SIC-SKGm', 'FontSize', textSize, 'FontWeight','bold', 'Location','northeast')
ylabel('BGR (bit per sample)', 'FontSize',15, 'FontWeight','bold')

% for i=1:length(compBGR)
%     text(ep(i)-0.3,compBGR(i,1),strcat(num2str(compBGR(i,1), '%.3g')), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(ep(i)-0.1,compBGR(i,2),strcat(num2str(compBGR(i,2), '%.3g')), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(ep(i)+0.1,compBGR(i,3),strcat(num2str(compBGR(i,3), '%.3g')," /"), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(ep(i)+0.3,compBGR(i,4),num2str(compBGR(i,4), '%.3g'), 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
% end

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.9',...
    'Position',[0.7 0.9 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.05',...
    'Position',[0.881650607457058 1.0455 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14 /',...
    'Position',[1.07247591118559 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14',...
    'Position',[1.34587348135735 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.94',...
    'Position',[1.7 0.94 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.07',...
    'Position',[1.88165060745706 1.0676 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14 /',...
    'Position',[2.07247591118559 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14',...
    'Position',[2.34587348135735 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.87',...
    'Position',[2.7 0.87 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.909',...
    'Position',[2.86330121491412 0.953854455445545 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14 /',...
    'Position',[3.07247591118559 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14',...
    'Position',[3.34587348135735 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','0.91',...
    'Position',[3.7 0.91 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.08',...
    'Position',[3.87247591118559 1.0822 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14 /',...
    'Position',[4.11834939254294 1.143 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'String','1.14',...
    'Position',[4.37339757017176 1.143 0]);

print('compvsquantBGR','-depsc')