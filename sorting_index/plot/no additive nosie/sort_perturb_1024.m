clear; close all; clc
textSize = 16;
linewid = 1;

% ISm-nothing 4 5 6 7
% ISm-without sorting 4 5 6 7
% ISm-without perturbation 4 5 6 7
% ISm-RSS 4 5 6 7

epiImpBMR = [
    1-0.6102579753 1-0.6935601128 1-0.7087565104 1-0.7203500601;
    1-0.8060465495 1-0.8498869243 1-0.89296875 1-0.9072265625;
    1-0.8097911005 1-0.8436306424 1-0.8705013021 1-0.8891225962;
    1-0.9681640625 0 0 0
    ];
epi = [4 5 6 7];

figure(111)
bar(epi, epiImpBMR(1:4,:)', 'grouped')
hold on
ax = gca;
ax.YAxis.FontSize = 14;
ax.XAxis.FontSize = 14;
ax.YAxis.FontWeight = 'bold';
ax.XAxis.FontWeight = 'bold';
ax.LineWidth = 1;
ylim([0 0.7]);
legend('SIM-SKG w.o. Sorting and Perturbation', 'SIM-SKG w.o. Sorting', 'SIM-SKG w.o. Perturbation', 'SIM-SKG', 'FontSize',textSize-2, 'FontWeight','bold', 'Location','northeast')
xlabel('Episode Length', 'FontSize', 15, 'FontWeight','bold')
ylabel('BMR', 'FontSize',15, 'FontWeight','bold')
grid on
% for i=1:length(epiImpBMR)
%     text(epi(i)-0.275,epiImpBMR(1,i),strcat(num2str(epiImpBMR(1,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(epi(i)-0.125,epiImpBMR(2,i),strcat(num2str(epiImpBMR(2,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(epi(i)+0.125,epiImpBMR(3,i),strcat(num2str(epiImpBMR(3,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(epi(i)+0.275,epiImpBMR(4,i),strcat(num2str(epiImpBMR(4,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
% end

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.39',...
    'Position',[3.725 0.3897420247 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.19',...
    'Position',[3.94839757017176 0.191136549091549 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.19',...
    'Position',[4.11276707163804 0.225420167105634 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.032',...
    'Position',[4.36674696271471 0.0318359375 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.31',...
    'Position',[4.725 0.3064398872 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.15',...
    'Position',[4.96063049853372 0.152929977108451 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.16',...
    'Position',[5.0944176790951 0.185946822388732 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0',...
    'Position',[5.275 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.29',...
    'Position',[5.725 0.2912434896 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.11',...
    'Position',[5.96063049853372 0.12534110915493 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.13',...
    'Position',[6.0944176790951 0.161893064097183 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0',...
    'Position',[6.275 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.28',...
    'Position',[6.725 0.2796499399 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.093',...
    'Position',[7.00344574780059 0.105449493838028 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.11',...
    'Position',[7.10665060745706 0.134821065771831 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0',...
    'Position',[7.275 0 0]);

print('epiCSIwithout','-depsc')