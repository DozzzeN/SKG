clear; close all; clc
textSize = 16;
linewid = 1;

% ISm-without sorting 5 6 7 8
% ISm-without perturbation 5 6 7 8
% ISm-RSS  5 6 7 8
% ISm-nothing 5 6 7 8

epiImpBMR = [
    1-0.6311598558 1-0.6440204327 1-0.6516200474 1-0.6622588489;
    1-0.7972380809 1-0.8199819712 1-0.8527919224 1-0.8707350128;
    1-0.9080061983 1-0.9128094059 1-0.9203488372 1-0.9240833333;
    0.00014 0 0 0;
%     1-0.6742966644 1-0.6858258929 1-0.6972803102 1-0.7078260281;
    ];
epi = [5 6 7 8];

figure(111)
bar(epi, epiImpBMR(1:4,:)', 'grouped')
hold on
ax = gca;
ax.YAxis.FontSize = 14;
ax.XAxis.FontSize = 14;
ax.YAxis.FontWeight = 'bold';
ax.XAxis.FontWeight = 'bold';
ax.LineWidth = 1;
ylim([0 0.7]);
legend('SIM-SKG w.o. Sorting and Perturbation', 'SIM-SKG w.o. Sorting', 'SIM-SKG w.o. Perturbation', 'SIM-SKG', 'FontSize',textSize-2, 'FontWeight','bold', 'Location','northeast')
xlabel('Episode Length', 'FontSize', 15, 'FontWeight','bold')
ylabel('BMR', 'FontSize',15, 'FontWeight','bold')
grid on
% for i=1:length(epiImpBMR)
%     text(epi(i)-0.25,epiImpBMR(1,i),strcat(num2str(epiImpBMR(1,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(epi(i)-0.05,epiImpBMR(2,i),strcat(num2str(epiImpBMR(2,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(epi(i)+0.25,epiImpBMR(3,i),strcat(num2str(epiImpBMR(3,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
%     text(epi(i)+0.25,epiImpBMR(4,i),strcat(num2str(epiImpBMR(4,i), '%.2g')), 'FontSize',12, 'FontWeight','bold', 'HorizontalAlignment', 'center', 'VerticalAlignment', 'bottom')
% end

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.37',...
    'Position',[4.74082530372853 0.3688401442 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.2',...
    'Position',[4.92247591118559 0.2027619191 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.092',...
    'Position',[5.19495182237118 0.0919938017 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.00014',...
    'Position',[5.35 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.36',...
    'Position',[5.73470883954755 0.355275341947887 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.18',...
    'Position',[5.95 0.1800180288 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.087',...
    'Position',[6.18577712609971 0.0871905941 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0',...
    'Position',[6.25 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.35',...
    'Position',[6.73165060745706 0.3483799526 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.15',...
    'Position',[6.95917469627147 0.1472080776 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.08',...
    'Position',[7.15825303728529 0.0796511628 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0',...
    'Position',[7.25 0 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.34',...
    'Position',[7.74082530372853 0.3377411511 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.13',...
    'Position',[7.95 0.1292649872 0]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0.076',...
    'Position',[8.18577712609971 0.0759166667 1.4210854715202e-14]);

% 创建 text
text('VerticalAlignment','bottom',...
    'HorizontalAlignment','center',...
    'FontWeight','bold',...
    'FontSize',12,...
    'String','0',...
    'Position',[8.25 0 0]);

print('epiCSIwithout','-depsc')