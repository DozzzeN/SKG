import matplotlib.pyplot as plt

# 理论上的分段数据
all_theoretical_segments = [
    {26: 351, 27: 3541590, 28: 1680166215, 29: 145614740985, 30: 3755513718450, 31: 36881505097621, 32: 159114492071763,
     33: 329183118163416, 34: 344391646501584, 35: 187417168205400, 36: 53444666709126, 37: 7880394608886,
     38: 578500918668, 39: 19665693177, 40: 271656775, 41: 1186458, 42: 903},

    {52: 338351, 53: 15232697935, 54: 61809207427170, 55: 56631993704568976, 56: 17578376610069794816,
     57: 2320386677229173342208, 58: 150473345756628617527296, 59: 5291519060795568886382592,
     60: 108353883302376305057595392, 61: 1362522863445778728113668096, 62: 10958568589249586942057644032,
     63: 58186967039327990649471369216, 64: 209099036316263769315064414208, 65: 518577001053946143169566474240,
     66: 901197894387295245471127175168, 67: 1110245870245812600791013261312, 68: 977914217980610583748946165760,
     69: 619349499690483120858418118656, 70: 282913505154269281420193038336, 71: 93254569451659789226416799744,
     72: 22134311683206213065376792576, 73: 3764559063603708666843234304, 74: 455138439180708003593584640,
     75: 38665519486671138565652480, 76: 2271629069427548968976384, 77: 90341110750175970721792,
     78: 2363381330471276773376, 79: 39131400728624209920, 80: 388884015407291904, 81: 2151008571747600,
     82: 5913051398046, 83: 6714295956, 84: 2218839, 85: 85},

    {103: 187357, 104: 429963865071, 105: 54940691418350848, 106: 1294333480971339300864,
     107: 9246127941093837267533824, 108: 26313523508427573170978947072, 109: 35424148707088281162168030724096,
     110: 25373426450970916291515816517566464, 111: 10529946915207559132987634720480165888,
     112: 2700263535405477788779047031122822168576, 113: 449915570711748101321358199382576497426432,
     114: 50703822377925299200851036503625998564065280, 115: 3993556232254984707470153349369176999610810368,
     116: 225881493088558464439812498824292674901169405952, 117: 9386669255285158816542773652829987590851459547136,
     118: 292194209031400576327354129026604627001839062089728,
     119: 6927594947669406515449533139276986986088256960987136,
     120: 126907596895371567210513558143571675903246505307275264,
     121: 1818949575598674452463489117350393264719274626345074688,
     122: 20622271737243778300191495074290331907619389757441703936,
     123: 186730267408958980491868240644237167317619507782806929408,
     124: 1361890208008649074263558743691773454340991316882251317248,
     125: 8060820809872921490832399800110813509033635533087358058496,
     126: 38977580117446160791307438648188494654675389125728573325312,
     127: 154885223922804551604809763077770916113053552708199903133696,
     128: 508434169721119652375246957859513783313280162881036781355008,
     129: 1385155682701026844465087127089312120037433699049238859612160,
     130: 3144673880241120596282705995616494583896073254756778615242752,
     131: 5970701581730607107025691413399195501766822717906016190595072,
     132: 9510652392310107996633092161860964635296702589231926003892224,
     133: 12744130243330066864963758726388417778993908941919311427010560,
     134: 14399051921059870747794262378005616639720936427271556324917248,
     135: 13744498494196851027019585015118999383878780216595182409220096,
     136: 11101684796233934401978186798566328449048592373368778584489984,
     137: 7597303838457976087722645630638613703686491616410507568742400,
     138: 4409022389740381005461079964711704464145741124870469658345472,
     139: 2171187717582595712564231749592190238286864567146885836439552,
     140: 907494815659177581243046314753068461802167148080196917133312,
     141: 321929587366838494506348521526797595751943721883729269882880,
     142: 96890788318274713522391253103304706730874017733122952527872,
     143: 24722744498165604067136191222613913410165173828812676268032,
     144: 5342425560636235045822168445408944329475888497104032628736,
     145: 976298578231666901225396831014803667781158230979642392576,
     146: 150603140690627481747776078005394116877658559193295093760,
     147: 19566593675168669630278284743005584620602107403257774080,
     148: 2135263709302187054852134274581785739153694545370152960,
     149: 195097694151515065355868305094956438190807270981369856,
     150: 14869192102825554589232315231412350998656884091650048,
     151: 941153621684651959723733678014821130426889227206656,
     152: 49223601784271098374168080998136688471253637398528, 153: 2114870546589167653435986725138214589694597922816,
     154: 74140018048329121796041648554904070523205976064, 155: 2104156684764283675879575059323845864635498496,
     156: 47908360531929044410588912649979753427632128, 157: 865864631424554907398977004911409248600064,
     158: 12268711550180367353358319859629872381952, 159: 134303271831429953143584480521808248832,
     160: 1116137870993865113441997557011054592, 161: 6894994538622497409128605060956160,
     162: 30855389215036182338174374117376, 163: 96862790460275306265919356928, 164: 204758494336189379045752832,
     165: 276242412765913255247872, 166: 221092569493133099008, 167: 94525289601235504, 168: 18348823804311,
     169: 1215790394, 170: 14535},

    {205: 205, 206: 113777320231, 207: 953052551083920256, 208: 965555197002256272588800,
     209: 236996978708718944867697295360, 210: 20091882769982148520927076680728576,
     211: 729559833317435723095606160404061880320, 212: 13106059796927875944678609071076961859665920,
     213: 129128517796354764407658295258690514356589821952, 214: 753774144651660510287114643169617043339575012884480,
     215: 2767786234896445358769125423538646279850370615901945856,
     216: 6705279511955655643840532258242413064545982455714781593600,
     217: 11142160517539571110905584786884358294182239311492666852638720,
     218: 13115392155788747268576639103844660113262848612122818920044298240,
     219: 11236399069370770361415928446727373237563014478529071656809795682304,
     220: 7170388433261587958229521427904057998999470904070480915272430233059328,
     221: 3476761465492362780071431402555540706805466796434696438332641246477025280,
     222: 1303301815443995124829033925650314673151062183305460426248366079458389524480,
     223: 383485750169333486987960372032141384169021046518453381290593481317444558520320,
     224: 89766628780119842943416275072547113556580646112311261098320646550993784115560448,
     225: 16917006935092196250738327622036519006987265752869423209071305815026191659977146368,
     226: 2594232942435497254796709933012325761091621815197024749177302589339909860485786238976,
     227: 326841350420221043680653871748965819710190633656891575674815600095493339025470836965376,
     228: 34124795717590666295644268516136376635677034053992644822457183634563023107640129092583424,
     229: 2975916715159763330882065371023235171670616546857580425903601606210492788591309482398580736,
     230: 218321419875109560698711819369755071573302853776629675574550100129221688814374098701889044480,
     231: 13562377969623229788074790844423185430691137446376657695406589485655327500160820246897372430336,
     232: 717697782628686764645831798384144874352322735842626144217397338773481096045997644306295224795136,
     233: 32531640433567736639671016451056960330867583640251826822257002671524234966746409868122378851057664,
     234: 1269504010290149939202718051696253563915112965139059179033797901891537005273653003283515209433481216,
     235: 42851255688603003827252085177838868923340399663285191948116569620276727137229442729210729482413932544,
     236: 1256554734527513189326789627747846923493482006502738567936372636995622053147058545703057808599526932480,
     237: 32139477719445709632723618796893519221850544194541143075778272378560203992390932993220790446099108200448,
     238: 719720580174432994315087231460144647297196476078116540503518821631672985559223845461430045475820972015616,
     239: 14160322194353976530440622353471566049835443768428050431881300342210153750779050966521530590524733466345472,
     240: 245573222925369698742496864579640842779557984271471391635070850887924624611255116570124172247487484656615424,
     241: 3765381520387251086661595382630600816218833225421895221017969121840447449600905917380804413080711547284619264,
     242: 51190943442694657772030402720987915296910779648217895501474595074748633178014755898239116605719102863924264960,
     243: 618715538041400541798838586329357866565593120333148362022500655997645194891705288545475531704456488852146618368,
     244: 6664811348935465890912276918391764064926577665965014991726368157696857811404493745808384406500903089278524850176,
     245: 64136014295913791864375601838110984462070780534172659207613008679189342111983779101838785230191585326512776151040,
     246: 552573027835836179311550843595999513897177012535155737825086065259454364623626891571221602678621919874361658966016,
     247: 4271198710339595806616219239260056765637050964655953312958832383069609992064662311559137589479624223269584644341760,
     248: 29677507365518704253308269865283725816758146347619334096508367744830436252245600496149311311904860165358147191439360,
     249: 185702507689075135164496235975052643932702671582638017762671447384409948587743340418872894314815799274918799957032960,
     250: 1048260417473802971550079355428007161600488536468781178560161024675771400321345526818096424496057656852950682043416576,
     251: 5346704654604085933182953655149443750236386683225131956786520359144459821523993585926708523300342418554555549916069888,
     252: 24679258938361879778667814903939172356643521836390507903547683136714735731677130326432792676322502583829447572178599936,
     253: 103236075812003522317193631755596738540999185234593937923657153452299264210298310645538492160022580520661379075153068032,
     254: 391897297182100330595430854671391906946539879216565052997038384400011221607748957758447744059998485261039337693308256256,
     255: 1351785609846797442318366864443472895183612133876700908101532873757766995357034225210121452186069369529538902866408767488,
     256: 4241883443322791786698399604061854196664747101873183278461026348732858646121787366913348946393520156085651303744608927744,
     257: 12123122154218744697874040065739098125397353019184547831660237731436581242506444118839687173208512421999334465067391385600,
     258: 31588932039833159891647920782575360732204431524207063710010521455247466149540465489054173572809681282658005361910517596160,
     259: 75119340642431295111650378535051368434687644956155282657363590944051855586407240837839301835331378790666106888615175913472,
     260: 163181016419197993273118621179424431377636857235885986548617038737496879289929722965732732624435064339005525628944442720256,
     261: 324091321929320634141930999923410769015810443704375063981620679527585699661266597086373109654676052789573283980696568725504,
     262: 588978106063168996897895870959103457783830403597344665222243709639180937224352785493592178389993615663433584293850852098048,
     263: 980155831633636109951696600323000818899383068831407106405272715781627938389220696573970527444277993424698978873002988404736,
     264: 1494729515541210606715711369654914928702544941106546973416302346473288666328487713053465160371903242552139429285661111222272,
     265: 2090194420823397998680586788704392163327362461112672148868760643685113879946210015265722051494772855150332750721373647667200,
     266: 2681828178275566161674269397447829185070702502371052773371601611992771804810370878323776167052587969970090548699046774571008,
     267: 3158916553152751801425167882155985376810115005673186616061313437863193366344843407470601804676912240119335952065619677937664,
     268: 3417674959268485841018030439842459369175644983231149223799856600256425407535738742655033518300914623640269173132942437777408,
     269: 3397906589697042472600411748425451486411143710149125314167267363305099860437063409753285004864414772832604209210557785440256,
     270: 3105728807323917497158666851996430069618163359338771829375811846049694703101896813502951878917425685073997634620658531958784,
     271: 2610666689270536881587227139381694085474269204230055327586142535999382177091299232819977778810351575196923267509408722059264,
     272: 2018928302627895506615863210565373428641218366702438953027839753896196765872337239084220465813669276982271877768284746022912,
     273: 1436810075514445836931740207014012530678679078693169907163437775513085864533867335870792881187309769397971856182413583450112,
     274: 941230846928746259851051377252901864072720015109928283859384794081911483800702498639942107205994051170413987707573063647232,
     275: 567678759133167299186038989362695785290788770917213480191628350175621238688565925262968632900041717776181919429394585092096,
     276: 315277100809944966427218432603492912575664276970591124763651795677782050163740694327524771038721573386608808127210182410240,
     277: 161258036950032717202089719681375900549153543212617417121981118809907616614513984518208095287201121289460717257991785545728,
     278: 75967466875940362575194679783440044634508965296359275053195365083095876087569007790967678962085498704944269485583242362880,
     279: 32963379932041671790787778503264740896057547160522273681710876409373962526278953485091593635523022830094412629397410414592,
     280: 13174567165816692686759872757090073651408558344486720323687037597630753749518369553610401813697210448649903263431169933312,
     281: 4849828065789744292585631861374443134709946630771821290453491745312081118185442353492916555896068678378963190343821950976,
     282: 1644252437571289304788407383651724698667465146306385167116498174374820971784925128545394289923903789102859628850421170176,
     283: 513347388071365396717343487313125505438696175960452797593549040079225509699546323002215387581482659366953897814732570624,
     284: 147565540398341827192033802571293816976347794828349780768832766096703119088176980821468178522974662908449398270059347968,
     285: 39048149739847241330263604775958259620003053464239776865822976742493060233167508147113122347033101143063116537028149248,
     286: 9509328044217455934677468261390814937544366396753861692182140715517357737361295307219752992768867009973347402173644800,
     287: 2130616768805310494870394219514516228917458472769291250386828525930376823270111705110820858157985584308646959554494464,
     288: 439055168719849605110697680011853614648307072362800694509354862729869164147667906595979120711760379444504937103360000,
     289: 83180673713359954997845137750224613713799816441971335334498123727644452381390453068282740615251327636392472572067840,
     290: 14481891666838264611523019758165637742288843467760004580127861936666275849422509527818926109388580972238415652192256,
     291: 2315876911309330947419187122970165095195642661654537258960227092177791815595325146606013780896990583786307164569600,
     292: 339983476013881160876709463843883013549385000177515450405124651236021466369060783727464338375348615551390800936960,
     293: 45792386782543325392938915810997104936190571408291829688749497359486060720125835810790956459812270230740416856064,
     294: 5655069985596562024975211758684378176880701842648019712108478859600302516680316746240637721213860728918518005760,
     295: 639855671559393658916176565928660641917212218428085848519892101098945598546965331021693934931839444990287675392,
     296: 66280879768362840190986268725079448583194756783610758522180287545118524544155231082518747168609595590484951040,
     297: 6280452811328294861178116961289891421750069550923273615525861157239684962516447840006901791809112759058038784,
     298: 543868890298916081027453240530079044174910151270919381766510583542356166600755377503563423842703894070165504,
     299: 43000186852665463069540840542644239064180066239034081641496409621437711552939495699347919095694385557274624,
     300: 3100687105237505518939866093924171343426773960520043535113402101283721238066844642265680344616617147105280,
     301: 203685388684704491323212233869792095308222708480848237134032371046397127036517147374779503632483996401664,
     302: 12174214562769332539272265854052735016443170499360265514547533935178066722773010991711280374382648623104,
     303: 661188641874366852325423685766525323819556022941427240770201454790374236982742379594294442494124883968,
     304: 32583216926356270092517206885291766102012711790403604646674544034528305293028521447238959143778779136,
     305: 1454724906648104704817844313906760053690783084447939552719471160003596851587078648512712872332099584,
     306: 58744905762166808416343561374645323317368642974386102669966977056929447713291031827637388661751808,
     307: 2141864501984824426748548814204681336972078189740249852388799130638758070103032586131842019622912,
     308: 70374894502494700493036851671548621467932006045060240798079356354561518766187647205133938327552,
     309: 2079483972554207971362966876404685993188588063564940887355287778595557178584378690712455086080,
     310: 55137167918506697190218545576896485610743136371995069131069155346684719781598795937649524736,
     311: 1308723694972435495545291161451041575831869729403350527274927586324289979669072109736296448,
     312: 27736205881591118767107599902019505320117961413724680119085388988832521681801622316908544,
     313: 523397706910640881102463020642633186919938135403975336895559374207962219776123995160576,
     314: 8767829983570053490511444401329828913157645010155492509570988532297888115128409260032,
     315: 129959133244406653573739694770543886718402291038515450750186871072055089274801881088,
     316: 1698365829739052192904228951615107347683506800978535368287904248532288452262100992,
     317: 19493188922208664835621850962720452547413005923676039369875006782229125355536384,
     318: 195670101736772116645623874585583091567018017043492174670090215899856036167680,
     319: 1709795694179558072623810031182700814656258249886547834442202309845390983168,
     320: 12939949968550629130666447706088858821227880747365658550294207865259294720,
     321: 84344079109762007113730174903671933693701801836697129036593768173666304,
     322: 470561735099852114099283051372130024446647450912758940645762845900800,
     323: 2231651393033086125212602916558949217323758171962299422045556965376,
     324: 8927793938712222605431235886526440557750187096296193430833332224,
     325: 29869152471485644462418931655195873124370408763996408618418176,
     326: 82762445106978897678906725022559891517464668000200129773568,
     327: 187832104251391316920068148755193564800642121709108854784,
     328: 344770581684748172175831135335824207426066009785630720,
     329: 504381613176492278348339926980532191261084109242368, 330: 578152013100035104138334624659833550847468371968,
     331: 508890895490134178889412915127075160931172352, 332: 335758980001757691066908292796858547306496,
     333: 161248155438374025134443695482351910912, 334: 54347563349900213090628738861760512,
     335: 12271434096749445284463424569344, 336: 1746120194386200327037648896, 337: 143954246869542389153792,
     338: 6083214725578342400, 339: 108377749299924, 340: 566570135, 341: 341}]

# 实验结果的分段数据
all_experimental_segments = [
    ({31: 2925, 30: 2429, 32: 1486, 29: 620, 33: 286, 28: 42, 34: 23, 27: 2}),
    ({61: 1056, 62: 1041, 60: 676, 63: 549, 59: 260, 64: 213, 58: 52, 65: 48, 66: 6, 57: 4, 67: 1}),
    ({122: 375, 123: 373, 124: 323, 121: 276, 125: 189, 120: 151, 126: 96, 119: 78, 127: 47, 128: 21, 118: 11, 129: 7,
      116: 3, 117: 3}),
    ({245: 131, 247: 125, 244: 125, 246: 110, 243: 109, 242: 84, 248: 78, 249: 59, 241: 45, 240: 28, 250: 26, 251: 22,
      239: 13, 238: 8, 252: 4, 236: 3, 254: 2, 237: 2, 255: 1, 235: 1})
]

for i in range(len(all_experimental_segments)):
    # 计算总分段个数
    total_theoretical = sum(all_theoretical_segments[i].values())
    total_experimental = sum(all_experimental_segments[i].values())

    # 计算每种分段个数占总分段个数的比值
    theoretical_ratios = {key: value / total_theoretical for key, value in all_theoretical_segments[i].items()}
    experimental_ratios = {key: value / total_experimental for key, value in all_experimental_segments[i].items()}

    # 提取数据用于绘图
    theoretical_labels = list(theoretical_ratios.keys())
    theoretical_sizes = list(theoretical_ratios.values())

    experimental_labels = list(experimental_ratios.keys())
    experimental_sizes = list(experimental_ratios.values())

    # 绘制理论分段比例的柱状图
    plt.figure(figsize=(14, 7))

    plt.subplot(1, 2, 1)
    plt.bar(theoretical_labels, theoretical_sizes, color='blue')
    plt.xlabel('Segment Length')
    plt.ylabel('Proportion')
    plt.title('Theoretical Segment Length Proportions 4 * ' + str(2 ** (5 + i)))
    plt.yscale('log')

    # 绘制实验分段比例的柱状图
    plt.subplot(1, 2, 2)
    plt.bar(experimental_labels, experimental_sizes, color='orange')
    plt.xlabel('Segment Length')
    plt.ylabel('Proportion')
    plt.title('Experimental Segment Length Proportions 4 * ' + str(2 ** (5 + i)))

    # 显示图表
    plt.tight_layout()
    # plt.savefig('segment_length_proportions_4_' + str(2 ** (5 + i)) + '.svg', dpi=1200, bbox_inches='tight')

    plt.show()
